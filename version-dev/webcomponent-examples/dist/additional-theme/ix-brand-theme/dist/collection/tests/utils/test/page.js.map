{"version":3,"file":"page.js","sourceRoot":"","sources":["../../../../src/tests/utils/test/page.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport {\n  ElementHandle,\n  Page,\n  PageScreenshotOptions,\n  test as testBase,\n  TestInfo,\n} from '@playwright/test';\n\nasync function extendPageFixture(page: Page, testInfo: TestInfo) {\n  const originalGoto = page.goto.bind(page);\n  const originalSceenshot = page.screenshot.bind(page);\n  const theme = testInfo.project.metadata?.theme ?? 'theme-classic-dark';\n  testInfo.annotations.push({\n    type: theme,\n  });\n  page.goto = async (url: string, options) => {\n    const response = await originalGoto(\n      `http://127.0.0.1:8080/src/tests/${url}?theme=${theme}`,\n      options\n    );\n\n    await page.waitForTimeout(1000);\n    return response;\n  };\n\n  page.screenshot = async (options?: PageScreenshotOptions) => {\n    await page.waitForTimeout(150);\n    return originalSceenshot(options);\n  };\n\n  return page;\n}\n\nexport const regressionTest = testBase.extend({\n  page: async ({ page }, use, testInfo) => {\n    page = await extendPageFixture(page, testInfo);\n    await use(page);\n  },\n});\n\nexport const test = testBase.extend<{\n  mount: (selector: string) => Promise<ElementHandle<HTMLElement>>;\n  createElement: (\n    selector: string,\n    appendTo?: ElementHandle<Element>\n  ) => Promise<ElementHandle<HTMLElement>>;\n}>({\n  createElement: async ({ page }, use) => {\n    use((selector, appendTo) =>\n      page.evaluateHandle(\n        async ({ selector, appendTo }) => {\n          const elm = document.createElement(selector);\n\n          if (appendTo) {\n            appendTo.appendChild(elm);\n          }\n\n          return elm;\n        },\n        {\n          selector,\n          appendTo,\n        }\n      )\n    );\n  },\n  mount: async ({ page }, use, testInfo) => {\n    const theme = testInfo.project.metadata?.theme ?? 'theme-classic-dark';\n    testInfo.annotations.push({\n      type: theme,\n    });\n    await page.goto(\n      `http://127.0.0.1:8080/src/tests/utils/ct/index.html?theme=${theme}`\n    );\n    use((selector) => {\n      return page.evaluateHandle(\n        async ({ componentSelector }) => {\n          await window.customElements.whenDefined('ix-button');\n          const mount = document.querySelector('#mount');\n          mount.innerHTML = componentSelector;\n          return mount.children.item(0) as HTMLElement;\n        },\n        { componentSelector: selector }\n      );\n    });\n  },\n});\n"]}